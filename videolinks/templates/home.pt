<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal">
<head>
  <title>Youtube share</title>
</head>
<body>
  <span tal:condition="logged_in">
    Logged in as: ${logged_in}
    <a href="${request.application_url}/logout">Logout</a>
  </span>
  <span tal:condition="not logged_in">
    <a href="${request.application_url}/login">Login</a>
    <a href="${request.application_url}/register">Register</a>
  </span>
  <br>
  <a href="${request.application_url}/add_video">Add a video</a>
  <div style="width:800px">
    <ul>
      <li tal:repeat="video videos">
       
        <a href="${video.url}"><h4>${video.title}</h4></a>
        ${video.description[:300]}<span tal:condition=
              "python:len(video.description) > 300">...</span>
        <br>
        <div tal:define="voted_users [x.user_handler for x in video.votes];
          voted logged_in in voted_users">
        <span tal:condition="voted">upvoted</span>
        <a tal:condition="not voted" href="${request.application_url}/vote_video/${video.id}/1">upvote</a> 
        <span>score:${len(voted_users)}</span>
        </div>
        <a tal:condition="python:logged_in == video.owner_handler" 
          href="${request.application_url}/delete_video/${video.id}">delete</a>
      </li>
    </ul>  
  </div>
</body>
</html>